<html>
    <head># 페이지에 대한 정보
        <style>
            table, td, th {
                border: 1px solid black;
                text-align: center;
            }
      
            table {
                border-collapse: collapse;
            }
        </style>
        <!--2가지 취약점이 있다. 데이터 베이스와 입력값이다. ***해결 방법 = safe 를 지우면 된다. -->
        <!-- 다. 그러면 그냥 문자열로 저리된다. 정보가 꺠져서 들어온다. &lt 가 꺽쇠이다. 문자가 replace되어서 들어온다. 즉, 사용자의 입력값들을 replace하여 데이터 베이스에 저장되게 하자 그래도 화면 표시에서는 그대로 된다.  -->
        <!-- 핵심은 꺽쇠를 잘 컨트롤하라  라는 것이다. -->
        <script src="http://code.jquery.com/jquery-3.6.0.min.js" ></script> <!--스크립트가 동작에 영향을 미친다. -> jquery라는 명령어를 쓴다. -->
        <script type="text/javascript">  <!--특정 위치에 어떤 글자 를 넣고 싶을 때 (집어넣고) jquery라는 문법을 통해 넣는다. 위치를 잡기 좋다. -->
            $(document).ready(function(){ # document는 html문서 전체를 말한다. 랜더링 준비가 끝났냐??(화면 표시가 다 끝났냐?) 그러면 이제 function()을 실행할 것이다.
                reflected_xss_string = "{{reflected_xss_string|safe}}"; // 중괄호는 파이썬에서 넘겨준 변수들이다. (replace 되어진다) safe는 그대로 보여준다.
                <!-- input값으로 대입 개발자 도구에서 값을 확인할 수 있음 -->
                stored_xss_string = "{{stored_xss_string|safe}}";
                $("#inputText").val(reflected_xss_string); # 검색 박스에 넣기 '#'은 id를 의미 즉, id가 inputText로 되어있는 것을 선택하라 -> 사용자의 입력값을 출력해
                $("#reflected_xss_string").html(reflected_xss_string); # id가 reflected_xss_string에 html로 세팅하여 값을 보이게 하라 (html 형식으로 표시하라)
                $("#stored_xss_string").html(stored_xss_string); # 이것이 문제이다.
                #stored_xss_string인것을 html로 해석하여 넣어라
            });
        </script>
        <title>XSS</title>
</head>
    <body> <!--form으로 인풋값을 받는다.-->
        <form id = "xssText" action = "xss" method = "get"> <!--submit 버튼을 누르면 action이 실행 , xss get으로 구동-->
            <fieldset>
                <legend>XSS 실습</legend>
                XSS 스크립트:
                <input type="text" id="inputText" name="inputText"> <!--inputText라는 이름으로 데이터가 전달 - 입력 값을 보여주라 -->
                <input type="submit" name="button"  value="실행"> # button이라는 이름으로 실행이 전달된다.
            </fieldset>
        </form>
    
    
        <h4>스크립트 표시</h4> <!-- 입력 박스에 스크립트 넣고 database에도 스크립트 내용이라면 2개 다 실행된다 -->
        <hr># 밑줄
        [reflected_xss]# 표시한다.
        <div id ="reflected_xss_string"> </div> <!--사용자의 입력값이 있으면 값이 표시된다 , 여기도 공격 대상이 된다. -->
        [stored_xss]
        <div id ="stored_xss_string"> </div> <!-- database에서 받은 정보를 html로 인식되어 안에 script 가 실행된다, 그냥 문자열인 줄 알았는데 그 내용이 html 이었다. ) -->

    </body>
</html>